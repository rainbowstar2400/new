# PRD v0.1

- 作成日: 2026-02-06
- プロダクト名（仮）: 自分専用秘書PWA
- 参照: `ProductBrief_v0.1.md`, `UseCases_v0.1.md`
- 対象リリース: MVP

## 1. 概要

本プロダクトは、会話的入力からタスク・メモ・リマインドを一気通貫で扱う、個人向けPWAである。  
初期版はローカル保存のみを前提とし、入力負荷を最小化しながら「忘れ防止」を実現する。

## 2. 目的

- 話しかけるだけで記録が完了すること
- タスク/メモ分類とメモ内サブ分類を自動化すること
- リマインドを柔軟に調整できること
- 確認が必要な場面では最小のUI操作で確定できること

## 3. 非目的（MVPでやらない）

- アカウント登録
- クラウド同期
- サーバー側保存
- 運営側データ収集

## 4. 対象ユーザー

- 初期: 作成者本人（自己運用で検証）
- 将来: 同種課題を持つ個人ユーザー

## 5. 機能スコープ（MVP）

- 会話的なテキスト入力
- 自動分類（タスク/メモ）
- メモ内サブ分類（やりたいこと/アイデア/メモ）
- 期日確認フロー（3択）
- 期限日時確定フロー（日付のみ入力時の既定時刻補完 + `○/✕`）
- リマインド作成とオフセット調整
- 対象タスク曖昧時の候補確認（`○/✕`）
- 自然会話応答（テンプレート + `〇〇` 要約スロット）
- 一覧表示と最低限の編集
- ローカル通知

## 6. 用語定義

- 期日状態 `due_state`
- `scheduled`: 期日日時が確定している状態
- `no_due`: 意図的に期日なしを選んだ状態
- `pending_due`: 後で期日設定を選んだ状態（一覧で `!期日設定` 表示）
- 既定時刻 `default_due_time`
- 日付のみ入力時に補完する時刻（設定値）

## 7. 機能要件（FR）

| ID | 要件 |
| --- | --- |
| FR-01 | ユーザー入力をタスク/メモへ分類できること |
| FR-02 | タスク/メモが曖昧な場合、保存前に確認質問を返すこと |
| FR-03 | メモは `やりたいこと/アイデア/メモ` の3分類に自動振り分けできること |
| FR-04 | タスクで期日未指定時、`設定する/設定しない/後で設定する` を提示すること |
| FR-05 | `設定する` 選択時のみ、自然言語で期日入力を受け付けること |
| FR-06 | `設定しない` は `no_due`、`後で設定する` は `pending_due` として保存すること |
| FR-07 | `pending_due` タスクは一覧で `!期日設定` 強調表示し、`no_due` と区別すること |
| FR-08 | 期限が日付のみの場合、`default_due_time` を補完して `○/✕` 確認を返すこと |
| FR-09 | `○/✕` 確認で `✕` が選ばれた場合のみ自然言語補足入力を受け付けること |
| FR-10 | 期限は必ず日時で保存し、日付のみ状態を残さないこと |
| FR-11 | リマインド時刻はオフセット指示（例: `1時間前`, `30分前`, `前日`）を解釈できること |
| FR-12 | オフセットまたは対象タスクが曖昧な場合、候補提示して `○/✕` 確認すること |
| FR-13 | 対象タスク確認で `✕` が選ばれた場合のみ自然言語で対象指定を受け付けること |
| FR-14 | 応答文はテンプレート固定とし、`〇〇` 要約スロットのみAI生成すること |
| FR-15 | `〇〇` は入力尊重で生成し、未確定情報を付与しないこと |
| FR-16 | 生成不適切時は安全なフォールバック文へ切り替えること |
| FR-17 | ローカル通知をスケジュールし、通知タップで対象項目へ遷移できること |
| FR-18 | 端末内保存のみで完結し、個人データを外部送信しないこと |

## 8. 受け入れ基準（主要）

- `UC-02`: 期日未指定タスクで3択が表示される
- `UC-08`: 日付のみ入力時、既定時刻確認が表示される
- `UC-14`: `1時間前` 指示が正しい通知時刻へ反映される
- `UC-16`: `後で設定する` 選択タスクが `!期日設定` で強調表示される
- `UC-17`: 対象曖昧時に `対象タスクは〇〇で良いですか？` が返る

## 9. 確認UI仕様

- 3択確認: `設定する/設定しない/後で設定する`
- `○/✕` 確認: システム提案値（時刻、対象タスク、解釈結果）に対する確認
- `○`: 即確定
- `✕`: 補足の自然言語入力受付へ遷移

## 10. データ要件

### 10.1 Task

- `id`: string
- `title`: string
- `kind`: `task` or `memo`
- `memo_category`: `want` or `idea` or `misc` or null
- `due_state`: `scheduled` or `no_due` or `pending_due`
- `due_at`: datetime or null
- `default_due_time_applied`: boolean
- `created_at`: datetime
- `updated_at`: datetime

### 10.2 Reminder

- `id`: string
- `task_id`: string
- `base_time`: datetime
- `offset_minutes`: integer
- `notify_at`: datetime
- `status`: `active` or `done` or `canceled`

### 10.3 Conversation Context（直近確認）

- `pending_type`: 確認種別
- `candidate_task_ids`: 候補タスクID
- `proposed_due_at`: 提案日時
- `proposed_offset`: 提案オフセット
- `expires_at`: 有効期限

## 11. 非機能要件（NFR）

- 性能: 入力開始から保存完了5秒以内を80%以上で達成
- 品質: 分類修正率（タスク/メモ）20%以下、メモ内25%以下
- 会話品質: 自然さ自己評価4.0/5以上
- 通知品質: 通知確認率70%以上
- リマインド調整成功率: 95%以上
- プライバシー: ローカル保存のみ、外部送信なし
- 可用性: オフライン前提で主要機能が利用可能

## 12. KPI

- 習慣化: 週5日以上利用
- 速度: 5秒以内保存率80%以上
- 分類精度（タスク/メモ）: 手動修正率20%以下
- 分類精度（メモ内）: 手動修正率25%以下
- 会話品質: 自己評価4.0以上
- リマインド調整成功率: 95%以上
- 忘れ防止: 導入前2週間比で30%以上削減
- 通知有効性: 通知後10分以内確認率70%以上

## 13. リリース判定条件（MVP）

- `UC-01` から `UC-17` のP0項目が受け入れ基準を満たす
- `pending_due` と `no_due` の表示差分が確認できる
- `○/✕` フローで `✕` 時のみ自然言語入力を受け付ける
- 日付のみ期限の保存が発生しない
- ローカル通知が端末で機能する

## 14. 実装優先順（要約）

- P0: コア登録、期日3択、時刻補完確認、オフセット調整、対象確認、`!期日設定` 表示
- P1: 補足ケース（時刻未指定リマインド提案、相対日付の拡張精度）
- P2: 境界ケースの改善と文面チューニング
