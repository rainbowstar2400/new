# Backlog v0.2

- 作成日: 2026-02-07
- 参照: `PRD_v0.2.md`, `UseCases_v0.2.md`, `Backlog_v0.1.md`
- 目的: Online MVP実装のチケット定義

## 1. 運用ルール

- 優先度は `P0 > P1 > P2`
- 受け入れ条件は FR/UC に紐づける
- `P0` 完了をMVPリリースの前提とする
- 仕様変更時は `Documents/*_v0.2.md` と `Issues/*_v0.2.md` を同時更新する

## 2. P0 バックログ（MVP必須）

| ID | 種別 | タイトル | 主な内容 | 依存 | 受け入れ条件 |
| --- | --- | --- | --- | --- | --- |
| P0-01 | Data | ドメインモデル定義 | `Task/Reminder/ConversationContext` と `due_state` 実装 | なし | FR-06, FR-07, FR-10 |
| P0-02 | Infra | PostgreSQL永続化 | テーブル定義、基本CRUD、マイグレーション | P0-01 | PRD 5章テーブル要件 |
| P0-03 | Logic | 入力分類エンジン | タスク/メモ分類 + 曖昧判定 | P0-01 | FR-01, FR-02, UC-13 |
| P0-04 | Logic | メモ内サブ分類 | `want/idea/misc` 分類 | P0-03 | FR-03, UC-11 |
| P0-05 | UI | 会話入力UI | 入力、送信、応答表示 | P0-03 | UC-01導線が成立 |
| P0-06 | UI/Flow | 期日3択UI | `設定する/設定しない/後で設定する` | P0-03 | FR-04, UC-02 |
| P0-07 | Logic | 3択保存分岐 | `scheduled/no_due/pending_due` 分岐保存 | P0-06 | FR-05, FR-06, UC-15, UC-16 |
| P0-08 | UI | `!期日設定` 表示 | `pending_due` の強調表示 | P0-07 | FR-07, UC-16 |
| P0-09 | UI/Flow | 日付のみ `○/✕` 確認 | 既定時刻補完確認UI | P0-06 | FR-08, UC-08 |
| P0-10 | Logic | `○/✕` 分岐 | `○` 即確定 / `✕` で自然言語入力 | P0-09 | FR-09, FR-10 |
| P0-11 | Logic | 期日自然言語解釈 | 相対日付/日時の解釈 | P0-07 | FR-05, UC-15 |
| P0-12 | Reminder | Web Push購読/配信基盤 | Service Worker、購読、配信 | P0-02 | FR-17, UC-19 |
| P0-13 | Reminder | オフセット解釈 | `1時間前/30分前/前日` など解釈 | P0-12 | FR-11, UC-14 |
| P0-14 | UI/Flow | 対象曖昧 `○/✕` | 候補確認と再指定導線 | P0-13 | FR-12, FR-13, UC-17 |
| P0-15 | NLG | テンプレート + GPT要約スロット | `〇〇` のみ生成 | P0-03 | FR-14, FR-15 |
| P0-16 | NLG | フォールバック制御 | 生成不適切時の deterministic 応答 | P0-15 | FR-16, UC-20 |
| P0-17 | Test | 単体/結合/主要E2E | 主要UCの自動検証 | P0-01〜P0-16 | PRD 10章受け入れを満たす |
| P0-18 | API | 匿名デバイス登録API | `/v1/installations/register` 実装 | P0-02 | FR-19, UC-18 |
| P0-19 | API | チャットAPI | `/v1/chat/messages` 実装 | P0-03, P0-11 | UC-02/08/13/14/17 |
| P0-20 | API | Push購読API | `/v1/push/subscribe` 実装 | P0-12 | FR-20, UC-19 |
| P0-21 | Job | 通知配信ジョブ | 1分間隔で配信対象処理 | P0-12, P0-20 | 通知重複送信がない |

## 3. P1 バックログ（精度・UX改善）

| ID | 種別 | タイトル | 主な内容 | 依存 | 受け入れ条件 |
| --- | --- | --- | --- | --- | --- |
| P1-01 | Reminder | 時刻未指定リマインド改善 | 時刻未指定時の確認文統一、既定時刻提案と `○/✕` 導線を強化 | P0-09, P0-13 | UC-05/UC-08 で提案内容が明確で、`✕` 後のみ自然言語入力へ遷移する |
| P1-02 | Logic | 相対日付解釈精度強化 | `OPENAI_DUE_PARSE_MODE=ai-first`、AI解釈 + 厳格検証、検証失敗時確認戻し | P0-11 | AI解釈の検証失敗で自動保存されず `due_choice` に戻る |
| P1-03 | UX/API | 確認UIの操作性改善 | `ChatMessageResponse` に `inputMode` / `confirmationType` / `negativeChoice` を追加しWebで入力制御 | P0-05, P0-19 | `choice_only` で自由入力不可、`choice_then_text_on_negative` で `✕` 後のみ自由入力可能 |

## 4. P2 バックログ（品質向上）

| ID | 種別 | タイトル | 主な内容 | 依存 | 受け入れ条件 |
| --- | --- | --- | --- | --- | --- |
| P2-01 | NLG | 応答文チューニング | 文体一貫性・自然さ改善 | P0-16 | 会話品質KPI改善 |
| P2-02 | Logic | 境界ケース拡張 | 稀な曖昧入力の再確認強化 | P0-17 | 失敗率低減 |
| P2-03 | UX | 一覧画面微調整 | `!期日設定` などの視認性改善 | P0-08 | 視認性評価改善 |

## 5. 将来検討（MVP外）

- メール認証
- 複数アカウント管理
- 高度な推薦

## 6. v0.1 回帰チェック（v0.2でも維持）

- `明日18時に洗濯` はタイトル `洗濯`
- `〜たい` は `memo(want)`
- `転職準備` は確認質問を返してから保存

## 7. リリースゲート（MVP）

- P0-01〜P0-21 完了
- PRD v0.2 の主要受け入れ基準を満たす
- 主要E2Eが緑化し、実機で通知導線を確認できる
